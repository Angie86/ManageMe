<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    
    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
            <h1>
                Manage Scrum
            </h1>
        </section>

        <!-- Main content -->
        <section class="content">
            <!-- Small boxes (Stat box) -->
            <div class="row">
                <!-- Left col -->
                <h:form>
                    <div class="box-group">
                        <div class="input-group">

                            <div class="input-group-btn">
                                <h:inputText id="nombreTarea" class="form-control"  value="#{scrumBean.nombreTarea}"  />
                            </div>
                            <div class="input-group-btn">
                                <h:inputText id="duracionTarea" class="form-control"  value="#{scrumBean.duracionTarea}" />
                            </div>
                            <div class="input-group-btn">
                                <h:inputText id="descripcionTarea" class="form-control"  value="#{scrumBean.description}" />
                            </div>
                            <div class="input-group-btn">
                                <h:inputText id="fechaInicio" class="form-control" value="#{scrumBean.fechaInicio}" pt:type="date" />
                            </div>

                            <div class="input-group-btn">
                                <h:commandButton action="#{scrumBean.createTask()}" id="crearTarea" class="btn btn-success" value="crearTarea" />

                            </div>

                        </div> 

                    </div>
                </h:form>

                <script>

                    function crearTarea() {

                        /*var nombreTarea = $('#nombreTarea').val();
                         $( "#toDo" ).append( '<li class="sortable-item" style=""><form><label>'+nombreTarea+'</label></form></li>' );*/
                    }


                </script>

                <br/><br/>


                <div class="dhe-example-section" id="ex-1-3">
                    <div class="dhe-example-section-header"></div>
                    <div class="dhe-example-section-content">

                        <!-- BEGIN: XHTML for example 1.3 -->

                        <div id="example-1-3">

                            <div id="toDo" class="column left first"><h2 class="tituloCentro">To Do</h2>

                                <ul id="toDoUl" class="sortable-list ui-sortable">
                                    <ui:repeat var="task" value="#{scrumBean.listaTasks}" >
                                        <h:form pt:id="formTask-#{task.idTask}" rendered="#{task.state=='To Do'}">
                                            <li class="sortable-item">
                                                <h:inputHidden pt:id="state-#{task.idTask}" value="#{scrumBean.state}" />
                                                <h:outputText value="#{task.nameTask}" />
                                                <h:commandButton class="hidden" pt:id="saveTask-#{task.idTask}"  action="#{scrumBean.saveTask(task.idTask)}" />
                                            </li>
                                        </h:form>
                                    </ui:repeat>

                                </ul>

                            </div>


                            <div id="doing2" class="column left"><h2 class="tituloCentro">Doing</h2>

                                <ul id="doingUl" class="sortable-list ui-sortable">
                                    <ui:repeat var="task" value="#{scrumBean.listaTasks}" >
                                        <h:form pt:id="formTask-#{task.idTask}"  rendered="#{task.state=='Doing'}">
                                            <li class="sortable-item">
                                                <h:inputHidden pt:id="state-#{task.idTask}" value="#{scrumBean.state}" />
                                                <h:outputText value="#{task.nameTask}" />
                                                <h:commandButton class="hidden" pt:id="saveTask-#{task.idTask}"  action="#{scrumBean.saveTask(task.idTask)}" />
                                            </li>
                                        </h:form>
                                    </ui:repeat>
                                </ul>

                            </div>

                            <div id="done2" class="column left"><h2 class="tituloCentro">Done</h2>

                                <ul id="doneUl" class="sortable-list ui-sortable">

                                    <ui:repeat var="task" value="#{scrumBean.listaTasks}" >
                                        <h:form pt:id="formTask-#{task.idTask}" rendered="#{task.state=='Done'}">
                                            <li class="sortable-item">
                                                <h:inputHidden pt:id="state-#{task.idTask}" value="#{scrumBean.state}" />
                                                <h:outputText value="#{task.nameTask}" />
                                                <h:commandButton  pt:id="saveTask-#{task.idTask}"  action="#{scrumBean.saveTask(task.idTask)}" />
                                            </li>
                                        </h:form>
                                    </ui:repeat>

                                </ul>

                            </div>

                            <div class="clearer">&nbsp;</div>


                        </div>

                        <!-- END: XHTML for example 1.3 -->

                    </div>
                </div>







            </div>  
        </section>
    </div>


    <!-- Example JavaScript files -->
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.0/jquery-ui.min.js"></script>

    <!-- Example jQuery code (JavaScript)  -->
    <script type="text/javascript">

                    $(document).ready(function () {

                        // Example 1.3: Sortable and connectable lists with visual helper
                        $('#example-1-3 #toDoUl').sortable({
                            connectWith: '#example-1-3 .sortable-list',
                            placeholder: 'placeholder',
                            handle: '.sortable-item',
                            receive: function (event, ui) {
                                lanchEvent(event, ui);
                            }

                        });

                        $('#example-1-3 #doingUl').sortable({
                            connectWith: '#example-1-3 .sortable-list',
                            placeholder: 'placeholder',
                            handle: '.sortable-item',
                            receive: function (event, ui) {
                                lanchEvent(event, ui);
                            }

                        });

                        $('#example-1-3 #doneUl').sortable({
                            connectWith: '#example-1-3 .sortable-list',
                            placeholder: 'placeholder',
                            handle: '.sortable-item',
                            receive: function (event, ui) {
                                lanchEvent(event, ui);
                            }

                        });

                    });
                    function lanchEvent(event, ui) {
                        var idTareaForm = ui.item.closest('ul form ').attr('id');
                        var idUl = ui.item.closest('ul').attr('id');
                        var idTarea = idTareaForm.split("-")[1];
                        
                        $("#" + idTareaForm + " #state-" + idTarea).val(idUl);
                        alert();
                        
                        
                        $("#" + idTareaForm + " #saveTask-" + idTarea).trigger( "click");

                    }

    </script>

    <!-- This is NOT a part of the example code (Google Analytics) -->
    <script type="text/javascript" src="http://www.google-analytics.com/ga.js"></script>
    <script type="text/javascript">try {
                        var pageTracker = _gat._getTracker("UA-223188-18");
                        pageTracker._setDomainName(".devheart.org");
                        pageTracker._trackPageview();
                    } catch (err) {
                    }
    </script>





</html>







